<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maze</title>
  <link rel="stylesheet" href="./EstiloLaberinto.css">
  <script src="button-panel.js" defer></script>
</head>
<body>

  <div id="page">

    <div id="Message-Container">
      <div id="message">
        <h1>Felicidades!</h1>
        <p>Lo hiciste muy Bien.</p>
        <p id="moves"></p>
        <input id="okBtn" type="button" onclick="toggleVisablity('Message-Container')" value="Vale!" />
      </div>
    </div>

    <br>
    <div id="menu">
      <div class="custom-select">
        <select id="diffSelect">
                  <option value="10">Facil</option>
                  <option value="15">Medio</option>
                  <option value="25">Dificil</option>
                  <option value="38">Extremo</option>                                      
              </select>
      </div>
      <input id="startMazeBtn" type="button" onclick="makeMaze()" value="Start" />
    </div>

    <div id="view">
      <div id="mazeContainer">
        <canvas id="mazeCanvas" class="border" height="1100" width="1100"></canvas>
      </div>
    </div>

    <p id="instructions">Usa las flechas del teclado para mover la llave a la casa</p>

  </div>

    <!-- Notificación de logro desbloqueado -->
    <div id="achievement-popup" class="popup hidden">
      <img id="achievement-icon" src="" alt="Icono del logro" class="achievement-icon" />
      <div class="achievement-text">
        <h3 id="achievement-title">¡Logro desbloqueado!</h3>
        <p id="achievement-name"></p>
      </div>
    </div>
    <button-panel></button-panel>
    <script>
      const tiempoLimiteMinutos = 1; // Cambia este valor para ajustar los minutos
      const tiempoLimiteMilisegundos = tiempoLimiteMinutos * 60 * 1000;
      const tiempoNotificacionMilisegundos = tiempoLimiteMilisegundos - 5000; // 5 segundos antes
    
      // Función para mostrar una notificación
      function mostrarNotificacion() {
        alert("El tiempo se agotará en 5 segundos. Se redirigirá al inicio.");
      }
    
      // Función para redirigir a la página de inicio
      function redirigirInicio() {
        window.location.href = "pantallazo.html"; 
      }
    
      // Configuración del temporizador para mostrar la notificación
      setTimeout(mostrarNotificacion, tiempoNotificacionMilisegundos);
    
      // Configuración del temporizador para redirigir después del tiempo límite
      setTimeout(redirigirInicio, tiempoLimiteMilisegundos)
      </script>

<script>
	(function () {
	const startTime = Date.now();
	const habilidadIndex = 1; // Página 1 -> Habilidad 1
	function saveProgress() {
			const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
			const currentProgress = JSON.parse(localStorage.getItem("progress")) || [0, 0, 0, 0, 0];
			currentProgress[habilidadIndex] = Math.min(currentProgress[habilidadIndex] + elapsedTime, 100);
			localStorage.setItem("progress", JSON.stringify(currentProgress));
	}
	window.addEventListener("beforeunload", saveProgress);
	})();
  (function () {
	const startTime = Date.now();
	const habilidadIndex = 2; // Página 1 -> Habilidad 1
	function saveProgress() {
			const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
			const currentProgress = JSON.parse(localStorage.getItem("progress")) || [0, 0, 0, 0, 0];
			currentProgress[habilidadIndex] = Math.min(currentProgress[habilidadIndex] + elapsedTime, 100);
			localStorage.setItem("progress", JSON.stringify(currentProgress));
	}
	window.addEventListener("beforeunload", saveProgress);
	})();
	</script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.touchswipe/1.6.18/jquery.touchSwipe.min.js"></script>
  <script src="./Laberinto.js"></script>
</body>
</html>